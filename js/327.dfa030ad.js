(self["webpackChunkdisk_final"]=self["webpackChunkdisk_final"]||[]).push([[327],{7327:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return g}});var o=function(){var t=this,e=t._self._c;return e("div",[e("div",[t.loginBoxSize>30?e("div",{staticClass:"filter showAnimate",on:{click:t.loginShow}}):t._e(),e("el-card",{style:{marginTop:"10px",width:`${t.loginBoxSize}vw`,height:"98vh",position:"fixed",top:"0",right:"-5px",background:"rgba(255,255,255,0.1)",transition:"all 0.2s",borderRadius:"0px",borderRadius:"25px 0 0 25px",border:"0"},attrs:{"body-style":"padding:0"}},[e("div",{class:{loginBoxContainer:!0,showAnimate:t.showInnerBox,outAnimate:!t.showInnerBox}},[t.showLoginBox?e("el-card",{class:{loginBox:!0,showAnimate:t.showLoginBox,outAnimate:!t.showLoginBox}},[e("div",{staticClass:"inputBox"},[e("div",{staticClass:"title"},[t._v(" 欢迎回来 ")]),e("el-form",{ref:"formDom",attrs:{model:t.formData,rules:t.rules}},[e("el-form-item",{attrs:{prop:"name"}},[e("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"用户名"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),e("el-form-item",{attrs:{prop:"password"}},[e("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"密码",type:"password"},model:{value:t.formData.password,callback:function(e){t.$set(t.formData,"password",e)},expression:"formData.password"}})],1)],1),e("div",{staticClass:"loginBtnContainer"},[e("el-button",{staticClass:"loginBtn",on:{click:t.login}},[t._v(" 登录 ")])],1)],1),e("div",{staticClass:"toSign"},[e("el-button",{attrs:{type:"text"},on:{click:t.toSign}},[t._v(" 没有账号？去注册 ")])],1)]):e("el-card",{class:{signBox:!0,showAnimate:!t.showLoginBox,outAnimate:t.showLoginBox}},[e("div",{staticClass:"inputBox"},[e("div",{staticClass:"title"},[t._v(" 欢迎加入我们 ")]),e("el-form",{ref:"signDom",attrs:{model:t.signData,rules:t.rules}},[e("el-form-item",{attrs:{prop:"name"}},[e("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"用户名"},model:{value:t.signData.name,callback:function(e){t.$set(t.signData,"name",e)},expression:"signData.name"}})],1),e("el-form-item",{attrs:{prop:"password"}},[e("el-input",{staticStyle:{width:"280px"},attrs:{type:"password",placeholder:"密码"},model:{value:t.signData.password,callback:function(e){t.$set(t.signData,"password",e)},expression:"signData.password"}})],1),e("el-form-item",{attrs:{prop:"password2"}},[e("el-input",{staticStyle:{width:"280px"},attrs:{type:"password",placeholder:"确认密码"},model:{value:t.signData.password2,callback:function(e){t.$set(t.signData,"password2",e)},expression:"signData.password2"}})],1),e("el-form-item",{attrs:{prop:"email"}},[e("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"邮箱"},model:{value:t.signData.email,callback:function(e){t.$set(t.signData,"email",e)},expression:"signData.email"}})],1),e("el-form-item",{attrs:{prop:"code"}},[e("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"验证码"},model:{value:t.signData.code,callback:function(e){t.$set(t.signData,"code",e)},expression:"signData.code"}}),e("el-button",{staticStyle:{"margin-left":"25px"},on:{click:t.sendMsg}},[t._v(" 发送验证码 ")])],1)],1),e("div",{staticClass:"signBtnContainer"},[e("el-button",{staticClass:"signBtn",on:{click:t.sign}},[t._v(" 注册 ")])],1)],1),e("div",{staticClass:"toLogin"},[e("el-button",{attrs:{type:"text"},on:{click:t.toLogin}},[t._v(" 已有账号？去登录 ")])],1)])],1),t.closeBtnShow?e("div",{class:{close:!0,showAnimate:t.closeBtnShow,outAnimate:!t.closeBtnShow},on:{click:t.loginShow}},[e("i",{staticClass:"el-icon-close"})]):t._e()])],1)])},i=[],n=(s(7658),s(3017)),r=s.n(n),a=s(2223),l={name:"LoginDisk",data(){var t=(t,e,s)=>{e!==this.signData.password?s(new Error("两次输入密码不一致!")):s()};return{closeBtnShow:!1,loginBoxSize:0,loginBoxWidth:23,formData:{name:"",password:""},rules:{name:[{required:!0,message:"用户名不能为空",trigger:"blur"},{min:2,max:10,message:"用户名2-10位",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,max:20,message:"密码6-20位",trigger:"blur"}],password2:[{required:!0,message:"确认密码不能为空",trigger:"blur"},{validator:t,trigger:"blur"},{min:6,max:20,message:"密码6-20位",trigger:"blur"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"}]},signData:{name:"",password:"",password2:"",email:"",code:""},showLoginBox:!0,showInnerBox:!1,closeTimer:null,loginTimer:null}},mounted(){r().subscribe("login",(()=>{this.loginShow()})),this.$store.state.user&&this.$store.state.user.token||(console.log("无token"),this.loginBoxSize=0,this.loginShow())},methods:{loginShow(){this.$refs.formDom&&this.$refs.formDom.resetFields(),this.$refs.signDom&&this.$refs.signDom.resetFields(),78.2===this.loginBoxSize?(this.loginBoxSize=0,this.showInnerBox=!this.showInnerBox):(this.loginBoxSize=78.2,this.showInnerBox=!this.showInnerBox),this.closeBtnShow?this.closeBtnShow=!1:(this.closeTimer&&(clearTimeout(this.closeTimer),this.closeTimer=null),this.closeTimer=setTimeout((()=>{this.closeBtnShow=!0}),500))},login(){try{console.log(this.$refs.formDom),this.$refs.formDom.validate((async t=>{if(t){const{data:t}=await(0,a.x4)(this.formData);this.$store.commit("setUser",t.data),console.log(t),t.data?(this.$message.success("登陆成功"),n.PubSub.publish("updateUserInfo"),this.loginShow()):"用户不存在"===t.msg&&(this.$message.warning("用户不存在"),this.showLoginBox=!1,this.$refs.formDom.resetFields())}}))}catch(t){this.$refs.formDom.resetFields(),this.$message.warning(t)}},sign(){try{this.$refs.signDom.validate((async t=>{if(t){const{data:t}=await(0,a.Xx)(this.signData);console.log(t),this.showLoginBox=!0,t.msg&&this.$message.warning(t.msg)}}))}catch(t){this.loginShow(),this.$refs.signDom.resetFields(),this.$message.warning(t)}},sendMsg(){let t=[];this.$refs.signDom.validateField(["name","password","password2","email"],(async e=>{if(e);else if(t.push(e),4==t.length&&t.every((t=>""===t))){const{data:t}=await(0,a.g_)(this.signData);console.log(t),t.msg&&this.$message.warning(t.msg)}}))},toSign(){this.$refs.formDom.resetFields(),this.showLoginBox=!1},toLogin(){this.$refs.signDom.resetFields(),this.showLoginBox=!0}}},c=l,u=s(1001),p=(0,u.Z)(c,o,i,!1,null,"429e4efb",null),g=p.exports},3017:function(t,e,s){t=s.nmd(t),s(7658),function(s,o){"use strict";var i={};s.PubSub?(i=s.PubSub,console.warn("PubSub already loaded, using existing version")):(s.PubSub=i,o(i)),void 0!==t&&t.exports&&(e=t.exports=i),e.PubSub=i,t.exports=e=i}("object"===typeof window&&window||this,(function(t){"use strict";var e={},s=-1,o="*";function i(t){var e;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!0;return!1}function n(t){return function(){throw t}}function r(t,e,s){try{t(e,s)}catch(o){setTimeout(n(o),0)}}function a(t,e,s){t(e,s)}function l(t,s,o,i){var n,l=e[s],c=i?a:r;if(Object.prototype.hasOwnProperty.call(e,s))for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&c(l[n],t,o)}function c(t,e,s){return function(){var i=String(t),n=i.lastIndexOf(".");l(t,t,e,s);while(-1!==n)i=i.substr(0,n),n=i.lastIndexOf("."),l(t,i,e,s);l(t,o,e,s)}}function u(t){var s=String(t),o=Boolean(Object.prototype.hasOwnProperty.call(e,s)&&i(e[s]));return o}function p(t){var e=String(t),s=u(e)||u(o),i=e.lastIndexOf(".");while(!s&&-1!==i)e=e.substr(0,i),i=e.lastIndexOf("."),s=u(e);return s}function g(t,e,s,o){t="symbol"===typeof t?t.toString():t;var i=c(t,e,o),n=p(t);return!!n&&(!0===s?i():setTimeout(i,0),!0)}t.publish=function(e,s){return g(e,s,!1,t.immediateExceptions)},t.publishSync=function(e,s){return g(e,s,!0,t.immediateExceptions)},t.subscribe=function(t,o){if("function"!==typeof o)return!1;t="symbol"===typeof t?t.toString():t,Object.prototype.hasOwnProperty.call(e,t)||(e[t]={});var i="uid_"+String(++s);return e[t][i]=o,i},t.subscribeAll=function(e){return t.subscribe(o,e)},t.subscribeOnce=function(e,s){var o=t.subscribe(e,(function(){t.unsubscribe(o),s.apply(this,arguments)}));return t},t.clearAllSubscriptions=function(){e={}},t.clearSubscriptions=function(t){var s;for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&0===s.indexOf(t)&&delete e[s]},t.countSubscriptions=function(t){var s,o,i=0;for(s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&0===s.indexOf(t)){for(o in e[s])i++;break}return i},t.getSubscriptions=function(t){var s,o=[];for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&0===s.indexOf(t)&&o.push(s);return o},t.unsubscribe=function(s){var o,i,n,r=function(t){var s;for(s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&0===s.indexOf(t))return!0;return!1},a="string"===typeof s&&(Object.prototype.hasOwnProperty.call(e,s)||r(s)),l=!a&&"string"===typeof s,c="function"===typeof s,u=!1;if(!a){for(o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(i=e[o],l&&i[s]){delete i[s],u=s;break}if(c)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&i[n]===s&&(delete i[n],u=!0)}return u}t.clearSubscriptions(s)}}))},2223:function(t,e,s){"use strict";s.d(e,{Xx:function(){return n},g_:function(){return r},x4:function(){return i}});var o=s(4471);const i=t=>(0,o.Z)({url:"/user/login",method:"post",data:t}),n=t=>(0,o.Z)({url:"/user/register",method:"post",data:t}),r=t=>(0,o.Z)({url:"/user/register/sendCode",method:"post",data:t})}}]);
//# sourceMappingURL=327.dfa030ad.js.map